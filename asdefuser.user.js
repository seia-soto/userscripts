// ==UserScript==
// @encoding utf-8
// @name AdShield Defuser
// @description AdShield Defuser provides mitigation for AdShield trackers and advertisement services.
// @author HoJeong Go <seia@outlook.kr>
// @version 0.16.5
//
// @grant none
// @run-at document-start
//
// @match http://ygosu.com/*
// @match https://ygosu.com/*
// @match http://*.ygosu.com/*
// @match https://*.ygosu.com/*
// @match https://sportalkorea.com/*
// @match https://*.sportalkorea.com/*
// @match https://www.edaily.co.kr/*
// @match http://genshinlab.com/*
// @match https://genshinlab.com/*
// @match https://loawa.com/*
// @match https://forexlive.com/*
// @match https://*.forexlive.com/*
// @match https://www.dogdrip.net/*
// @match https://honkailab.com/*
// @match https://meeco.kr/*
//
// @namespace https://github.com/seia-soto/userscripts
// @homepageURL https://github.com/seia-soto/userscripts
// @supportURL https://github.com/seia-soto/userscripts
// @updateURL https://seia-soto.github.io/userscripts/asdefuser.user.js
// @downloadURL https://seia-soto.github.io/userscripts/asdefuser.user.js
// ==/UserScript==
"use strict";(()=>{var j=[{id:"fkad",input:"7z>g}{/W#`c[ZT&sI<2-haKXYn\no)xSFA",output:"niue8tmyacj3l91q65fxbwzrv7po2gk40",reserved1:115,reserved1Input:"1EHb.|u?p(qfPity'r6O%	w=]9BJRD;:8k",reserved1Output:"phm21v9cw4b73yglnfxotazsuj8qrk650i",reserved2:104,reserved2Input:'Qj^ NCUv54le"VMm_30GL',reserved2Output:"bixqrhwn9zjm54o12fe0s"},{id:"svmm",input:`maG;FT.e2cYzV:%i})g4bp-KUZy<wL
_?`,output:"1nwsr7vk8fh0l3ut92jigqx6z45cpbmyo",reserved1:97,reserved1Input:'krBJtD(Qlv^>#[h{X19o&SEAM/n"O= 05P',reserved1Output:"36qz0mv9tne7kwra5i1ujx28oyfspcglh4",reserved2:101,reserved2Input:"|`	'Rqj6CNWH]I8sx7u3f",reserved2Output:"wegyjpzux38q2a9vmifot"},{id:"cokq",input:`(r%96jVK7{kP	gDhOcFs'1;M"IuQZ/yqA`,output:"izxsomqh3p8bvga49w7fy2tluc6e5n01r",reserved1:106,reserved1Input:"^zG[wm\nC`=8Bv><&]0:T L#px3Xli-n).4",reserved1Output:"p91tzx4ibshwf3qyen506ugo2mkv8lrjc7",reserved2:107,reserved2Input:"EYf?RN2a}WbU5eH_|StJo",reserved2Output:"sm8fkhrwa94y0eupj2nq1"},{id:"znbg",input:"(	EHC_;s/.WgNfVl z9MYhQ}Tj:JFUS)#",output:"o5hkm78up2yxwvzsj0at1bglr6ei43ncq",reserved1:102,reserved1Input:`KZi{^4<m"5'c%
XLurypqA8[eIw-DR|kbB`,reserved1Output:"ou7ercvw9l01yghnfip685bzxqtak3sjm4",reserved2:57,reserved2Input:"=6a0G>POo37nv?x&1`]2t",reserved2Output:"crxmjf7yhgt6o3p8l09iv"},{id:"zmpc",input:`.Ip>szJ8EwahYM/v;yKc=f
([_T q3nOS`,output:"5nv1iegza269ju8soky04h3p7rltcxmbq",reserved1:119,reserved1Input:'QCABV"]#0jb&Wo6t:UuiHg1rPD4%)RlNk-',reserved1Output:"le4971m5irpukxjv3sq2o8y60gnbzthwfa",reserved2:102,reserved2Input:"G752e`LXx'Zm}9<	{?F",reserved2Output:"plbi21cxfmo36tn50uq"},{id:"fwbh",input:`x5A8hE9=
QG1"CuJ'oV(I)>lbW4D#e L6`,output:"wr275yogsj4kv03izcnx1uaqb8pflm6th",reserved1:57,reserved1Input:"3%t	{2rckfyXR]?NK&/Fgw;TSMmn-7_iU.",reserved1Output:"y93rfts7lxq8vkgjen5m0i6wzhap1ucb2o",reserved2:101,reserved2Input:"}qB<z`PZ[YH:0sjvaOp",reserved2Output:"6m7kwe3qaohu5g4bz8i"},{id:"qbuw",input:"i;Uj'[<w\"DT0lZLgS8f#hxsMV}ty:E-)`",output:"3c51goq40pzal9r6xuvtkey2swnj7mihb",reserved1:102,reserved1Input:`k96YK(v/&ICmGB	5bza?HcP_1W qRoA.=
`,reserved1Output:"mteqh0ys62p1fxj589ro4aunzlig3c7wbk",reserved2:56,reserved2Input:"{eF%OXrQ2>np3JN]47u",reserved2Output:"9jmanwyqx0s54zuto6h"},{id:"nloc",input:"x<[ykY%1-sK9_C0Raj#8OLl]/HwhqFU	3",output:"0ozupkrx6qjwnygl34m7i9th1f8v2bec5",reserved1:97,reserved1Input:'&m2GT5IrP" .B(o=:igbJpWnz7tcvNZ`>\n',reserved1Output:"74hfvbtcj2eroa0ul56yw3inqxkgp9m1zs",reserved2:115,reserved2Input:"uV6})Q'?D{SeAMX4;Ef",reserved2Output:"91ysxe8luorn6vpciwq"},{id:"kynb",input:'0Nm}ubC9L6k{7("nx>s=Ko]IBw/ySgf%W',output:"a274bcljtv0omw6z9g5p13us8ekhxirfq",reserved1:121,reserved1Input:"e?`3AU<2Z[;	iJEFV'|Pa8T5j-.v :q#H)",reserved1Output:"eow5rfluq8x4zgj70p13ci6mh2s9tnkabv",reserved2:110,reserved2Input:`&XD_QOhMrltpR1c4zG
Y`,reserved2Output:"c7863qbsmwy54otnhiv1"},{id:"uyyk",input:"Tx<W|XvcubCz-ekU/ oiM	&:%Ig>2h{s[",output:"mjb0feu6lzx7kqhgop4at831c92ywir5n",reserved1:118,reserved1Input:`5f;Vt"qDLB91'm
}?R6S(Z#A\`Jr0HQlKP)`,reserved1Output:"qp5r842ycvxjowbaz7uhts9gk6i0emn13f",reserved2:115,reserved2Input:"NGnE8a_y.FjYO=4w3]p7",reserved2Output:"kn1eho6fjbr40pxc9i2q"},{id:"rypa",input:`B8 /Y9o]VHC_p3yt
hTONi5q6IG-r=2g%`,output:"ul2ow01j9zq58mfk4cv37absyigteh6xn",reserved1:112,reserved1Input:`nEeJKa.:P{A;x0UL"4'XFm|}wfvzQ#7ZS(`,reserved1Output:"m8961qwzghu27xeoapn3k5ilvrfjc4syt0",reserved2:114,reserved2Input:"&j<RDs[W>bukM`c?1)	l",reserved2Output:"6akyhor80m37slfw1vxp"},{id:"ehor",input:`"q4
J3fkZhj&lt\`wH50T='g|(EP[B-QYD`,output:"7uil5a3gxbrptvjeymo4c09wqzs682nf1",reserved1:107,reserved1Input:"<GcpOI/	zAX%6?9o r.bmFRie>Ks_)v;Vu",reserved1Output:"ypwzx2usm8og5q74tanlb6ri3vcehj9kf1",reserved2:104,reserved2Input:"7y:x218]U#NC}nWaMS{L",reserved2Output:"bja3zkfvqltgu5sw678n"}];var l=()=>{let e=new Error;if(!e.stack)throw new Error("Stack trace is not available!");return e.stack},J=(e=l())=>{if(e.includes("@")){let n=e.split(`
`).slice(2),o=[];navigator.userAgent.includes("Firefox/")&&n.splice(-1,1);for(let s of n){let p=s.indexOf("@")+1,a=s.lastIndexOf(":"),i=a<0?s.slice(p):s.slice(p,s.lastIndexOf(":",a-1));o.push(i)}return o}let t=e.slice(6).split(`
`).slice(2),r=[];for(let n of t){let o=n.slice(n.indexOf("(")+1||n.indexOf("at")+3,n.lastIndexOf(":",n.lastIndexOf(":")-1));r.push(o)}return r},I=(e=J())=>{let t=0;for(let r of e){let n=r.indexOf("://");if(n===5||n===4)break;t++}return e.slice(t)};var b=["css-load.com","07c225f3.online","content-loader.com","error-report.com","html-load.com"],S=[...b,"blocking"],M=b.length,T=()=>b[Math.random()*M>>>0],m=(e=I())=>{if(e.length===0)return!1;for(let t of b)if(e[e.length-1].includes(t))return!0;return!1};var q="eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiIiwiZW1haWwiOiIiLCJleHAiOjE3MTE4OTA4NTksImlhdCI6MTcxMTgwNDQ1OX0.OCQlZuCbVJRnmZqsZMdR_u9EnLzpvp5bUwkw1ziQnhA",U=async e=>{let r=await(await fetch(e,{cache:"force-cache"})).text();if(r.length===0)throw new Error("Failed to fetch resource!");return"<style>"+r+"</style>"},z=async e=>{let r=await(await fetch(e,{cache:"force-cache"})).text(),n=/eyJ[\w-]*\.eyJ[\w-]*\.[\w-]*/.exec(r);if(n===null)throw new Error("Failed to match predefined token in the script!");return n[0]},C=async(e,t)=>{let r=/(resources:\/\/[^'"]+)/g,n=T(),o="",s=null;for(;(s=r.exec(e))!==null;){let p="https://"+n+"/resources/"+s[1].slice(12)+"?token="+t;o+=await U(p).catch(a=>(console.error(a),""))}return o};var f=e=>{let t=`[asdefuser:${e}]`;return new Proxy(console.debug,{apply(r,n,o){Reflect.apply(r,n,[t,...o])}})};var w={debug:!1};var k=f("secret"),g=(Date.now()*Math.random()).toString(36),d=(e,t,r)=>k(t?"-":"+","name="+e,"v=",r,"stack=",l()),K=(e,t=e.name,r={})=>(k("creating protected function",t),new Proxy(e,{apply(n,o,s){if(m())throw d(t,!0,s),new Error;if(r.arguments){for(let p of s)if(typeof p=="string"){for(let a of S)if(p.includes(a))throw d(t,!0,s),new Error}}return w.debug&&d(t,!1,s),Reflect.apply(n,o,s)},setPrototypeOf(n,o){throw d(t,!0,o),new Error}})),v=new Set,c=(e,t,r)=>{if(v.size===0){k("! creating protected object property descriptor handlers");let n=["defineProperty","defineProperties"],o=new Proxy(Object.defineProperty,{apply(p,a,i){let[u,y]=i;if(v.has(u[y])||m())throw d(n[0],!0,i),new Error;return w.debug&&d(n[0],!1,i),Reflect.apply(p,a,i)}}),s=new Proxy(Object.defineProperties,{apply(p,a,i){if(m())throw d(n[1],!0,i),new Error;let[u,y]=i;for(let x of Object.keys(y))if(v.has(u[x]))throw d(n[1],!0,i),new Error;return w.debug&&d(n[1],!1,i),Reflect.apply(p,a,i)}});v.add(s),v.add(o),Object.defineProperty(window.Object,"defineProperty",{get(){return o}}),Object.defineProperties(window.Object,{defineProperty:{get(){return o}},defineProperties:{get(){return s}}})}r===void 0&&typeof e[t]=="function"&&(r=K(e[t])),Object.defineProperty(e,t,{value:r}),v.add(r)};var E=f("storage"),P=()=>{c(window.Storage.prototype,"setItem",new Proxy(Storage.prototype.setItem,{apply(e,t,r){let[n,o,s]=r;if(m()||n.startsWith("asdf")&&s!==g)return E("- apply name=Storage.prototype.setItem","args=",r,"stack=",l()),!1;w.debug&&E("+ apply name=Storage.prototype.setItem","args=",r,"stack=",l()),Reflect.apply(e,t,[n,o])}})),c(window.Storage.prototype,"removeItem",new Proxy(Storage.prototype.removeItem,{apply(e,t,r){let[n,o]=r;if(m()||n.startsWith("asdf")&&o!==g)return E("- apply name=Storage.prototype.removeItem","args=",r,"stack=",l()),!1;w.debug&&E("+ apply name=Storage.prototype.removeItem","args=",r,"stack=",l()),Reflect.apply(e,t,[n])}})),c(window.Storage.prototype,"clear")},R=e=>localStorage.getItem("asdf-"+e,g),D=(e,t)=>{localStorage.setItem("asdf-"+e,t,g)};var L=f("entities");var W=e=>{let t=document.querySelector(e.selector);if(!t)throw new Error("The target node was not found in the frame!");t.before(e.textContent),t.remove()},Z=e=>{document.head.insertAdjacentHTML("beforeend",e.html)},V=async e=>{e.type===1?Z(e):e.type===0&&W(e)},O=async e=>Promise.allSettled(e.map(async t=>V(t))),N=async()=>{let e=R("entity-cache-rev2");if(!e)throw new Error("The cached entities does not exist on this browser!");let t=JSON.parse(e);if(Date.now()-t.createdAt>1e3*60*60*24*30)throw new Error("The cached entities are too old!");return L("restoring cached entities data=",t),await O(t.entities),!0},H=e=>{e.length!==0&&D("entity-cache-rev2",JSON.stringify({entities:e,createdAt:Date.now()}))};var A=async(e=document)=>{if(e.readyState==="loading")return new Promise(t=>{e.addEventListener("readystatechange",()=>{t()})})};var h=f("ztinywave"),Y=e=>{let t=e.slice(0,4),r=j.find(i=>i.id===t);if(!r)throw new Error("DEFUSER_ZTINYWAVE_KEY_NOT_FOUND");let n=String.fromCharCode(r.reserved1),o=String.fromCharCode(r.reserved2),s=(i,u,y)=>{let x=u.indexOf(y);return x>=0?i[x]:y},p=0,a=e.slice(4).split("").map(i=>{if(!p){if(i===n)return p=1,"";if(i===o)return p=2,""}return p===1?(p=0,r.reserved1Output.includes(i)?s(r.reserved1Input,r.reserved1Output,i):s(r.input,r.output,i)+i):p===2?(p=0,r.reserved2Output.includes(i)?s(r.reserved2Input,r.reserved2Output,i):s(r.input,r.output,i)+i):s(r.input,r.output,i)}).join("");return JSON.parse(a)},Q=async()=>{let e=[],t=()=>{let r=document.querySelectorAll('script[data]:not([data=""]),script[wp-data]:not([wp-data=""])');for(let n of r){let o=n.getAttribute("src"),s=n.getAttribute("data");o&&s&&e.push({script:o,data:s})}};if(t(),e.length===0&&(await A(document),t()),e.length===0)throw new Error("DEFUSER_ZTINYWAVE_TARGET_NOT_FOUND");return e},F=async()=>{if(await N().catch(o=>(h("Failed to initialise cached entities",o),!1)))return;let t=[],n=(await Q()).map(async o=>{h("source",o);let s=Y(o.data);h("payload",s);let p=[],a=[];for(let u of s)u.tags&&(u.tags.includes("resources://")?a.push({type:1,html:u.tags}):p.push({type:1,html:u.tags}));O(p);let i=await z(o.script).catch(u=>(h("DEFUSER_ZTINYWAVE_RESOURCE_TOKEN_NOT_FOUND",u),q));for(let u of a)u.type===1&&(u.html=await C(u.html,i));O(a),t.push(...p,...a)});h("sources resolves",await Promise.allSettled(n)),H(t)};var G=()=>{c(window,"Error"),c(window.EventTarget.prototype,"addEventListener"),c(window.MessagePort.prototype,"postMessage"),c(window.Element.prototype,"remove"),c(window.Element.prototype,"removeChild"),c(window.Element.prototype,"insertAdjacentElement"),c(window.Element.prototype,"insertAdjacentHTML"),c(window,"setInterval"),c(window,"setTimeout"),c(window.Element.prototype,"setAttribute"),c(window.Element.prototype,"setAttributeNS"),c(window.document,"createElement"),c(window.document,"createElementNS"),c(window,"alert"),c(window,"confirm"),c(window,"atob"),c(window,"decodeURI"),c(window,"decodeURIComponent"),P()},X=()=>{let e=['[class][style*="bottom: 0"][style*="justify-content: center"]','iframe[src*="error-report.com"]'];document.head.insertAdjacentHTML("beforeend",`<style>${e.join(",")}{display:none !important}</style>`)},B=()=>{G(),X(),F()};B();})();
